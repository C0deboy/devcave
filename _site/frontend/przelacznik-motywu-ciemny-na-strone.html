<!DOCTYPE html>
<html lang="pl">
<head>
    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Devcave - jaskinia programisty, blog programistyczny.">
<meta name="author" content="Codeboy">
<title>Jak zrobić tryb nocny/ciemny, przełącznik motywu na blogu/stronie</title>

<link rel="canonical" href="https://c0deboy.github.io/devcave/frontend/przelacznik-motywu-ciemny-na-strone">
<link rel="shortcut icon" href="/img/logo.ico">

<link rel="stylesheet" href="/dist/css/libs/bootstrap.min.css">
<link rel="stylesheet" href="/dist/css/devcave.min.css">
<link rel="stylesheet" href="/dist/css/syntax.min.css">
<link rel="stylesheet" href="/dist/css/libs/font-awesome.min.css">

<link href="//fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
<link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link type="application/atom+xml" rel="alternate" href="https://c0deboy.github.io/devcave/feed.xml" title="devcave.pl" />

</head>

<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img src="/img/devcave.png"> devcave.pl</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="nav-el" href="/o-mnie/">O mnie</a>
                </li>

                <li>
                    <a class="nav-el" href="/archiwum/">Archiwum</a>
                </li>

                <li>
                    <a class="nav-el" href="/kontakt/">Kontakt</a>
                </li>
                <li>
                    <a class="nav-el" href="/moje-projekty">Moje projekty</a>
                </li>
                <li>
                    <button class="dark-mode-btn nav-el" data-toggle="tooltip" data-placement="bottom" title="Zmień motyw">
                        <i class="fa fa-sun-o" aria-hidden="true"></i>/<i class="fa fa-moon-o" aria-hidden="true"></i>
                    </button>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <header class="post-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <div class="post-heading">
                    <h1>Przełącznik motywu, tryb nocny na blogu/stronie</h1>
                    
                    <h2 class="subheading">Tryb ciemny/jasny w łatwy sposób, tylko JS.</h2>
                    
                    <p class="meta">
                    
                    2
                    listopada
                      
                    2017</p>
                     <div class="site-tag"><a href='/archiwum#frontend'>Frontend</a></div> <div class="site-tag"><a href='/archiwum#jak-zrobić'>Jak-zrobić</a></div> 
                </div>
            </div>
        </div>
    </div>
</header>

<article>
    <div class="container post">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <hr class="header-hr">

                <span>Spis treści:</span>

                <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#przygotowywujemy-przycisk">Przygotowywujemy przycisk</a></li>
<li class="toc-entry toc-h1"><a href="#obsługujemy-zmianę-i-zapamiętujemy-wybór-w-localstorage">Obsługujemy zmianę i zapamiętujemy wybór w LocalStorage</a></li>
<li class="toc-entry toc-h1"><a href="#dostosowywanie-strony-do-zmian">Dostosowywanie strony do zmian</a></li>
</ul>

                <hr>

				        <p>Zawszę doceniam, gdy na stronach/blogach mamy możliwość zmiany motywu na ciemny. Jest to świetna opcja do czytania lub do przeglądania strony bez światła. Dlatego też zaimplementowałem taką funkcję na swoim blogu (w prawym górnym rogu w navbarze).</p>

<p>Pokażę jak to wykonałem - relatywnie szybko i bezboleśnie, na przykładzie tego bloga ;)</p>

<h1 id="przygotowywujemy-przycisk">Przygotowywujemy przycisk</h1>

<p>To kwestia gustu. Tutaj jest w navbarze - na liście opcji, z tooltipem i ikonami fontawsome:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"collapse navbar-collapse"</span> <span class="na">id=</span><span class="s">"bs-example-navbar-collapse-1"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!--  ...  --&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"dark-mode-btn nav-el"</span> <span class="na">data-toggle=</span><span class="s">"tooltip"</span> <span class="na">data-placement=</span><span class="s">"bottom"</span> <span class="na">title=</span><span class="s">"Zmień motyw"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"fa fa-sun-o"</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/i&gt;</span>/<span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"fa fa-moon-o"</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/i&gt;</span>
    <span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
 <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<h1 id="obsługujemy-zmianę-i-zapamiętujemy-wybór-w-localstorage">Obsługujemy zmianę i zapamiętujemy wybór w LocalStorage</h1>

<p>Zaimplementowałem to w ten sposób, że po kliknięciu przycisku przełączany jest motyw (u mnie dodawana jest klasa “dark-mode” do body) oraz zapamiętywany jest nasz wybór w <a href="https://developer.mozilla.org/pl/docs/Web/API/Window/localStorage">localStorage</a> - czyli w pamięci cache przeglądarki dopóki jej nie wyczyścimy.</p>

<p>Dałoby się to zrobić za pomocą ciasteczek, ale wykorzystanie localStorage jest bardziej odpowiednie, gdyż nie wysyłamy nic w nagłówku HTTP (nie marnujemy łącza :D) i nie wygaśnie nam to po jakimś czasie. Wszystkie dzieje się w przeglądarce użytkownika. Poza tym, ciasteczka są przeznaczone do odczytywania po stronie serwera.</p>

<p>Tak więc dodajemy obsługę kliknięcia:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.dark-mode-btn'</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">darkMode</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="s1">'dark-mode'</span><span class="p">);</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">blur</span><span class="p">();</span>
  <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'dark-mode'</span><span class="p">,</span> <span class="nx">darkMode</span><span class="p">);</span>
<span class="p">});</span></code></pre></figure>

<p><code class="highlight language-javascript" data-lang="javascript"><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">blur</span><span class="p">();</span></code> odznacza przycisk po kliknięciu, bez tego byłby aktywny.</p>

<p>Poza tym, przy otwieraniu strony powinien zostać wczytany zapamiętany wybór i zmieniony motyw jeśli jest taka potrzeba:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">if</span> <span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'dark-mode'</span><span class="p">)))</span> <span class="p">{</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'dark-mode'</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>U mnie klasa CSS zmieniającą motyw jest aż tak prosta:</p>

<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.dark-mode</span> <span class="p">{</span>
  <span class="nl">background</span><span class="p">:</span> <span class="m">#2a2a2a</span><span class="p">;</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#e2e2e2</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>Wiadomo, jęśli masz więcej elementów, którym będziesz chciał zmienić wygląd po przełączeniu motywu, tym więcej będziesz musiał stworzyć dodatkowych klas i dodać je później dynamicznie w JS do tych konkretnych elementów.</p>

<h1 id="dostosowywanie-strony-do-zmian">Dostosowywanie strony do zmian</h1>

<p>Pozostało nam dostosować bloga/stronę do takiej zmiany i w niektórych elementach CSS pozmieniać wartości <code class="highlight">background</code> i <code class="highlight">color</code> na <code class="highlight"><span class="m">inherit</span></code>, aby kolory były dziedziczone z klasy <code class="highlight"><span class="na">.dark-mode</span></code>. Poza tym, prawdopodobnie czeka nas kilka zmian kolorystycznych, aby dopasować się do dwóch trybów.</p>

<p class="note">
    Zdaję sobię, że nie u każdego będzie to takie banalne i czasem wasza strona może wymagać głębszej modyfikacji css, aby nasza strona wyglądała dobrze po zmianie motywu. Dlatego dobrze jest dobierać kolory, które wyglądają ładnie w obu motywach. Wtedy pójdzie to tak szybko jak u mnie ;)
</p>

<p class="idea">
Jeśli używasz Disqus na swojej stronie, to przy zmianie motywu sekcja komentarzy może nie wyglądać poprawnie. Jeśli masz zaznaczoną opcję, aby disqus dostosowywał wygląd automatycznie, możesz wymusić jego przeładowanie po zmianie motywu, aby ponownie się dopasowałAC. Wystarczy dodać taką linijkę tam gdzie obsługujemy kliknięcie:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">try</span> <span class="p">{</span>
    <span class="nx">DISQUS</span><span class="p">.</span><span class="nx">reset</span><span class="p">({</span> <span class="na">reload</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span></code></pre></figure>

<p>Jest to w try catch, ponieważ zakładam, że nie na każdej stronie masz sekcję komentarzy ;)</p>



                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/moje-do%C5%9Bwiadczenia/moja-droga-do-pierwszej-pracy" data-toggle="tooltip" data-placement="top" title="Moja droga do pierwszej pracy">&larr; Poprzedni post</a>
                    </li>
                    
                    
                </ul>

                <hr>
                
                

<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = "https://blog.jaki-jezyk-programowania.pl/frontend/przelacznik-motywu-ciemny-na-strone";
this.page.identifier = "/frontend/przelacznik-motywu-ciemny-na-strone";
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://jaki-jezyk-programowania.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Włacz JavaScript w twojej przeglądarce, aby zobaczyć <a href="https://disqus.com/?ref_noscript"> komentarze by Disqus.</a></noscript>



            </div>
        </div>
    </div>

</article>

<hr>



    <footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center social-buttons">
                    <li>
                        <a href="/feed.xml" data-toggle="tooltip" data-placement="top" title="RSS">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/C0deboy" data-toggle="tooltip" data-placement="top" title="Github">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="mailto:lasota.marcinm@gmail.com" data-toggle="tooltip" data-placement="top" title="lasota.marcinm@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                </ul>
                <p class="copyright text-muted">Copyright &copy; devcave 2017</p>
            </div>
        </div>
    </div>
</footer>


<script src="/dist/js/libs/jquery.min.js"></script>

<script src="/dist/js/libs/bootstrap.min.js"></script>

<script src="/dist/js/devcave.min.js"></script>

    

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90973428-2', 'auto');
  ga('send', 'pageview');

</script>




</body>

</html>
