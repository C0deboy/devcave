function getQueryVariable(e){const t=window.location.search.substring(1).split("&");for(let s=0;s<t.length;s++){const i=t[s].split("=");if(i[0]===e)return decodeURIComponent(i[1].replace(/\+/g,"%20"))}}class jekyllSearch{constructor(e,t,s){this.dataSource=e,this.searchField=document.querySelector(t),this.resultsList=document.querySelector(s),this.displayResults=this.displayResults.bind(this)}fetchedData(){return fetch(this.dataSource).then(e=>e.json())}async findResults(){return this.resultsList.innerHTML='<i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>',(await this.fetchedData()).filter(e=>{const t=this.searchField.value.trim().replace(/\s/g," | "),s=new RegExp(t,"gi");return e.titleSEO?e.title.match(s)||e.subtitle.match(s)||e.titleSEO.match(s):e.title.match(s)||e.subtitle.match(s)})}async displayResults(){const e=await this.findResults(),t=e.map(e=>`<li class="result"><div class="post-preview"><a href="${e.url}"><h2 class="post-title">${e.title}</h2><h3 class="post-subtitle">${e.subtitle}</h3></a><p class="post-meta">${e.date}</p></div></li>`).join("");0===e.length||""===this.searchField.value?this.resultsList.innerHTML="<p>Nic nie znaleziono</p>":this.resultsList.innerHTML=t}init(){this.searchField.addEventListener("keyup",this.displayResults),this.searchField.addEventListener("keypress",e=>{13==e.keyCode&&e.preventDefault()})}getUrlSearchQuery(){const e=getQueryVariable("szukaj");if(void 0!==getQueryVariable("nowadomena")){const t=document.createElement("p");t.innerText="Blog został przeniesiony na nową domenę. Czy szukałeś: ?",t.classList.add("new-domain-msg"),this.resultsList.parentElement.insertBefore(t,this.resultsList),e.replace(/\d/g,"")}void 0!==e&&(this.searchField.value=e.split(/[/\-_]/).filter(e=>e.match(/\w{3,}/)).join(" "),this.displayResults())}}